---
- include_tasks: common.yml
  vars:
    role: sshd-jump
    files:
      - setup.sh
      - sshd-jump.rc
      - Containerfile
      - container-entrypoint.sh
      - sshd_config
      - update-image.sh
    executable_files:
      - setup.sh
      - container-entrypoint.sh
      - sshd-jump.rc
      - update-image.sh

- delegate_to: localhost
  file:
    path: "{{ local_build_dir }}/sshd-jump/authorized_keys"
    state: directory


- name: Jump Users Authorized Keys
  delegate_to: localhost
  template:
    src: authorized_keys
    dest: "{{ local_build_dir }}/sshd-jump/authorized_keys/{{ user.name }}"
  loop: "{{ jump_users }}"
  loop_control:
    loop_var: user
